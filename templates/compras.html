<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quitandas SENAI - Compras</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Quitandas SENAI</h1>
        <nav>
            <ul>
                <li><a href="#produtos">Produtos</a></li>
                <li><a href="#carrinho">Carrinho</a></li>
                <li><a href="#" onclick="logout()">Sair</a></li>
            </ul>
        </nav>
    </header>

    <section id="produtos">
        <h2>Nosso Catálogo</h2>
        <div class="produto">
            <img src="pao.jpg" alt="Pão de queijo">
            <h3>Pão de Queijo</h3>
            <p>Delicioso pão de queijo caseiro.</p>
            <p>R$ 5,00</p>
            <button onclick="adicionarAoCarrinho('Pão de Queijo', 5.00)">Adicionar ao Carrinho</button>
        </div>
        <div class="produto">
            <img src="coxinha.jpg" alt="Coxinha">
            <h3>Coxinha</h3>
            <p>Salgado de frango empanado e frito, no formato de uma coxinha.</p>
            <p>R$ 4,00</p>
            <button onclick="adicionarAoCarrinho('Coxinha', 4.00)">Adicionar ao Carrinho</button>
        </div>
        
        <div class="produto">
            <img src="empada.jpg" alt="Empada">
            <h3>Empada</h3>
            <p>Massa crocante recheada com frango, carne ou camarão.</p>
            <p>R$ 6,00</p>
            <button onclick="adicionarAoCarrinho('Empada', 6.00)">Adicionar ao Carrinho</button>
        </div>
        
        <div class="produto">
            <img src="esphirra.jpg" alt="Esfiha">
            <h3>Esfiha</h3>
            <p>Deliciosa massa fina recheada com carne moída ou queijo.</p>
            <p>R$ 5,00</p>
            <button onclick="adicionarAoCarrinho('Esfiha', 5.00)">Adicionar ao Carrinho</button>
        </div>
        
        <div class="produto">
            <img src="kibe.jpeg" alt="Kibe">
            <h3>Kibe</h3>
            <p>Quibe frito, feito com trigo para quibe e carne moída.</p>
            <p>R$ 4,50</p>
            <button onclick="adicionarAoCarrinho('Kibe', 4.50)">Adicionar ao Carrinho</button>
        </div>
        
        <div class="produto">
            <img src="bolinho.jpg" alt="Bolinho de Bacalhau">
            <h3>Bolinho de Bacalhau</h3>
            <p>Bolinho frito recheado com bacalhau desfiado e batata.</p>
            <p>R$ 7,00</p>
            <button onclick="adicionarAoCarrinho('Bolinho de Bacalhau', 7.00)">Adicionar ao Carrinho</button>
        </div>
        
        <div class="produto">
            <img src="pastel.jpg" alt="Pastel">
            <h3>Pastel</h3>
            <p>Pastel crocante recheado com carne, queijo ou frango.</p>
            <p>R$ 6,00</p>
            <button onclick="adicionarAoCarrinho('Pastel', 6.00)">Adicionar ao Carrinho</button>
        </div>
        
        <div class="produto">
            <img src="torta.jpg" alt="Torta Salgada">
            <h3>Torta Salgada</h3>
            <p>Torta recheada com frango, carne ou legumes.</p>
            <p>R$ 8,00</p>
            <button onclick="adicionarAoCarrinho('Torta Salgada', 8.00)">Adicionar ao Carrinho</button>
        </div>
        <!-- Adicionar mais produtos aqui -->
    </section>

    <section id="carrinho">
        <h2>Seu Carrinho</h2>
        <ul id="lista-carrinho"></ul>
        <p>Total: R$ <span id="total">0.00</span></p>
        <button onclick="limparCarrinho()">Limpar carrinho</button>
        <button onclick="salvarTotalECaminhar()">Finalizar Pedido</button>
    </section>

    <script>
    document.addEventListener("DOMContentLoaded", (event) => {
        let usuarioLogado = localstorage.getItem("usuario");

        if (!usuarioLogado) {
            window.location.href = "index.html";
        }

        setTimeout(atualizarCarrinho, 1000); 
    })

function salvarTotalECaminhar() {
    let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    if (carrinho.length === 0) {
        alert("Seu carrinho está vazio!");
        return;
    }
    let total = document.getElementById("total").innerText;
    localStorage.setItem("totalCompra", total);
    window.location.href = "escolha_entrega.html";
}

function logout() {
    localStorage.removeItem("usuario");
    window.location.href = "index.html";
    }

function adicionarAoCarrinho(produto, preco) {
    let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    carrinho.push({ produto, preco });
    localStorage.setItem("carrinho", JSON.stringify(carrinho));
    atualizarCarrinho();
}

// function irParaPagamento() {
//     let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

//     if (carrinho.length === 0) {
//         alert("Seu carrinho está vazio!");
//         return;
//     }

//     window.location.href = "pagamento.html";
// }

function atualizarCarrinho() {
    let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    let listaCarrinho = document.getElementById("lista-carrinho");
    let total = 0;

    console.log("Atualizando...")

    listaCarrinho.innerHTML = "";
    carrinho.forEach((item, index) => {
        let li = document.createElement("li");
        li.innerHTML = `${item.produto} - R$ ${item.preco.toFixed(2)}  
        <button onclick="removerItem(${index})">❌ Excluir</button>`;
        listaCarrinho.appendChild(li);
        total += item.preco;
    });

    document.getElementById("total").textContent = total.toFixed(2);
}

function removerItem(index) {
    let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    carrinho.splice(index, 1); // Remove o item pelo índice
    localStorage.setItem("carrinho", JSON.stringify(carrinho));
    atualizarCarrinho();
}

function limparCarrinho() {
    localStorage.setItem("carrinho", JSON.stringify([]));
    atualizarCarrinho();

}

    </script>
</body>
</html>
